<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../../style/control.css">
    <link rel="stylesheet" href="http://maxiang.qiniudn.com/app/css/app.css?1408270014">
    <title>博客</title>
</head>
<body class="body">
    <div class="blog-item">
                    <div id="preview-contents" class="note-content" style="padding-left: 35px; padding-right: 35px; padding-bottom: 157px;">
                        <div id="wmd-preview" class="preview-content"></div>
                    <div id="wmd-preview-section-1051" class="wmd-preview-section preview-content">

</div><div id="wmd-preview-section-2233" class="wmd-preview-section preview-content">

<h2 id="java字符串">Java字符串</h2></div><div id="wmd-preview-section-2010" class="wmd-preview-section preview-content">

<h4 id="一个普通的字符串相加">一个普通的字符串相加：</h4></div><div id="wmd-preview-section-1459" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-dark"><code class="language-java hljs"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StringTest</span> </span>{<br><span class="hljs-comment line-number">2.</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>{<br><span class="hljs-comment line-number">3.</span>      String a = <span class="hljs-string">"a"</span>;<br><span class="hljs-comment line-number">4.</span>      String b = <span class="hljs-string">"b"</span>;<br><span class="hljs-comment line-number">5.</span>      String c = <span class="hljs-string">"c"</span>;<br><span class="hljs-comment line-number">6.</span>      String d = a + b + c;<br><span class="hljs-comment line-number">7.</span>      System.out.println(d);<br><span class="hljs-comment line-number">8.</span>    }<br><span class="hljs-comment line-number">9.</span>}<br></code></pre>

<p>javap看一下编译后的结果，可以看到+被转成了StringBuilder的append</p></div><div id="wmd-preview-section-2022" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-dark"><code class="language-bash hljs"><span class="hljs-comment line-number">1.</span>zeal@zeal-ThinkPad:~/tobenew$ javap -c StringTest<br><span class="hljs-comment line-number">2.</span>Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar <br><span class="hljs-comment line-number">3.</span>Compiled from <span class="hljs-string">"StringTest.java"</span><br><span class="hljs-comment line-number">4.</span>public class StringTest {<br><span class="hljs-comment line-number">5.</span>  public StringTest();<br><span class="hljs-comment line-number">6.</span>    Code:<br><span class="hljs-comment line-number">7.</span>       <span class="hljs-number">0</span>: aload_0       <br><span class="hljs-comment line-number">8.</span>       <span class="hljs-number">1</span>: invokespecial <span class="hljs-comment">#1                  // Method java/lang/Object."&lt;init&gt;":()V</span><br><span class="hljs-comment line-number">9.</span>       <span class="hljs-number">4</span>: <span class="hljs-built_in">return</span>        <br><span class="hljs-comment line-number">10.</span>  public static void main(java.lang.String[]);<br><span class="hljs-comment line-number">11.</span>    Code:<br><span class="hljs-comment line-number">12.</span>       <span class="hljs-number">0</span>: ldc           <span class="hljs-comment">#2                  // String a</span><br><span class="hljs-comment line-number">13.</span>       <span class="hljs-number">2</span>: astore_1      <br><span class="hljs-comment line-number">14.</span>       <span class="hljs-number">3</span>: ldc           <span class="hljs-comment">#3                  // String b</span><br><span class="hljs-comment line-number">15.</span>       <span class="hljs-number">5</span>: astore_2      <br><span class="hljs-comment line-number">16.</span>       <span class="hljs-number">6</span>: ldc           <span class="hljs-comment">#4                  // String c</span><br><span class="hljs-comment line-number">17.</span>       <span class="hljs-number">8</span>: astore_3      <br><span class="hljs-comment line-number">18.</span>       <span class="hljs-number">9</span>: new           <span class="hljs-comment">#5                  // class java/lang/StringBuilder</span><br><span class="hljs-comment line-number">19.</span>      <span class="hljs-number">12</span>: dup           <br><span class="hljs-comment line-number">20.</span>      <span class="hljs-number">13</span>: invokespecial <span class="hljs-comment">#6                  // Method java/lang/StringBuilder."&lt;init&gt;":()V</span><br><span class="hljs-comment line-number">21.</span>      <span class="hljs-number">16</span>: aload_1       <br><span class="hljs-comment line-number">22.</span>      <span class="hljs-number">17</span>: invokevirtual <span class="hljs-comment">#7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="hljs-comment line-number">23.</span>      <span class="hljs-number">20</span>: aload_2       <br><span class="hljs-comment line-number">24.</span>      <span class="hljs-number">21</span>: invokevirtual <span class="hljs-comment">#7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="hljs-comment line-number">25.</span>      <span class="hljs-number">24</span>: aload_3       <br><span class="hljs-comment line-number">26.</span>      <span class="hljs-number">25</span>: invokevirtual <span class="hljs-comment">#7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="hljs-comment line-number">27.</span>      <span class="hljs-number">28</span>: invokevirtual <span class="hljs-comment">#8                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span><br><span class="hljs-comment line-number">28.</span>      <span class="hljs-number">31</span>: astore        <span class="hljs-number">4</span><br><span class="hljs-comment line-number">29.</span>      <span class="hljs-number">33</span>: getstatic     <span class="hljs-comment">#9                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="hljs-comment line-number">30.</span>      <span class="hljs-number">36</span>: aload         <span class="hljs-number">4</span><br><span class="hljs-comment line-number">31.</span>      <span class="hljs-number">38</span>: invokevirtual <span class="hljs-comment">#10                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="hljs-comment line-number">32.</span>      <span class="hljs-number">41</span>: <span class="hljs-built_in">return</span>        <br><span class="hljs-comment line-number">33.</span>}<br></code></pre>

</div><div id="wmd-preview-section-2034" class="wmd-preview-section preview-content">

<h4 id="一个普通的final字符串相加">一个普通的final字符串相加：</h4></div><div id="wmd-preview-section-1636" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-dark"><code class="language-java hljs"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StringTest</span> </span>{<br><span class="hljs-comment line-number">2.</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>{<br><span class="hljs-comment line-number">3.</span>      <span class="hljs-keyword">final</span> String a = <span class="hljs-string">"a"</span>;<br><span class="hljs-comment line-number">4.</span>      <span class="hljs-keyword">final</span> String b = <span class="hljs-string">"b"</span>;<br><span class="hljs-comment line-number">5.</span>      <span class="hljs-keyword">final</span> String c = <span class="hljs-string">"c"</span>;<br><span class="hljs-comment line-number">6.</span>      String d = a + b + c;<br><span class="hljs-comment line-number">7.</span>      System.out.println(d);<br><span class="hljs-comment line-number">8.</span>    }<br><span class="hljs-comment line-number">9.</span>}<br></code></pre>

<p>可以看到3个final字符串直接被编译到了变量中</p></div><div id="wmd-preview-section-2047" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-dark"><code class="language-bash hljs"><span class="hljs-comment line-number">1.</span>zeal@zeal-ThinkPad:~/tobenew$ javap -c StringTest<br><span class="hljs-comment line-number">2.</span>Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar <br><span class="hljs-comment line-number">3.</span>Compiled from <span class="hljs-string">"StringTest.java"</span><br><span class="hljs-comment line-number">4.</span>public class StringTest {<br><span class="hljs-comment line-number">5.</span>  public StringTest();<br><span class="hljs-comment line-number">6.</span>    Code:<br><span class="hljs-comment line-number">7.</span>       <span class="hljs-number">0</span>: aload_0       <br><span class="hljs-comment line-number">8.</span>       <span class="hljs-number">1</span>: invokespecial <span class="hljs-comment">#1                  // Method java/lang/Object."&lt;init&gt;":()V</span><br><span class="hljs-comment line-number">9.</span>       <span class="hljs-number">4</span>: <span class="hljs-built_in">return</span>        <br><span class="hljs-comment line-number">10.</span>  public static void main(java.lang.String[]);<br><span class="hljs-comment line-number">11.</span>    Code:<br><span class="hljs-comment line-number">12.</span>       <span class="hljs-number">0</span>: ldc           <span class="hljs-comment">#2                  // String abc</span><br><span class="hljs-comment line-number">13.</span>       <span class="hljs-number">2</span>: astore        <span class="hljs-number">4</span><br><span class="hljs-comment line-number">14.</span>       <span class="hljs-number">4</span>: getstatic     <span class="hljs-comment">#3                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="hljs-comment line-number">15.</span>       <span class="hljs-number">7</span>: aload         <span class="hljs-number">4</span><br><span class="hljs-comment line-number">16.</span>       <span class="hljs-number">9</span>: invokevirtual <span class="hljs-comment">#4                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="hljs-comment line-number">17.</span>      <span class="hljs-number">12</span>: <span class="hljs-built_in">return</span>        <br><span class="hljs-comment line-number">18.</span>}<br></code></pre>

</div><div id="wmd-preview-section-2048" class="wmd-preview-section preview-content">

<h4 id="另一个普通的字符串相加">另一个普通的字符串相加：</h4></div><div id="wmd-preview-section-2217" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-dark"><code class="language-java hljs"><span class="hljs-comment line-number">1.</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StringTest</span> </span>{<br><span class="hljs-comment line-number">2.</span>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>{<br><span class="hljs-comment line-number">3.</span>     <span class="hljs-keyword">final</span> String a = <span class="hljs-string">"a"</span>;<br><span class="hljs-comment line-number">4.</span>     String b = <span class="hljs-string">"b"</span>;<br><span class="hljs-comment line-number">5.</span>     <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">5</span>; i++) {<br><span class="hljs-comment line-number">6.</span>        b = b + a;<br><span class="hljs-comment line-number">7.</span>     }<br><span class="hljs-comment line-number">8.</span>     System.out.println(b);<br><span class="hljs-comment line-number">9.</span>   }<br><span class="hljs-comment line-number">10.</span>}<br></code></pre>

<p>可以看到构造出了一堆的StringBuilder(goto语句)</p></div><div id="wmd-preview-section-1950" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-dark"><code class="language-bash hljs"><span class="hljs-comment line-number">1.</span>zeal@zeal-ThinkPad:~/tobenew$ javap -c StringTest<br><span class="hljs-comment line-number">2.</span>Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar <br><span class="hljs-comment line-number">3.</span>Compiled from <span class="hljs-string">"StringTest.java"</span><br><span class="hljs-comment line-number">4.</span>public class StringTest {<br><span class="hljs-comment line-number">5.</span>  public StringTest();<br><span class="hljs-comment line-number">6.</span>    Code:<br><span class="hljs-comment line-number">7.</span>       <span class="hljs-number">0</span>: aload_0       <br><span class="hljs-comment line-number">8.</span>       <span class="hljs-number">1</span>: invokespecial <span class="hljs-comment">#1                  // Method java/lang/Object."&lt;init&gt;":()V</span><br><span class="hljs-comment line-number">9.</span>       <span class="hljs-number">4</span>: <span class="hljs-built_in">return</span>        <br><span class="hljs-comment line-number">10.</span><br><span class="hljs-comment line-number">11.</span>  public static void main(java.lang.String[]);<br><span class="hljs-comment line-number">12.</span>    Code:<br><span class="hljs-comment line-number">13.</span>       <span class="hljs-number">0</span>: ldc           <span class="hljs-comment">#2                  // String b</span><br><span class="hljs-comment line-number">14.</span>       <span class="hljs-number">2</span>: astore_2      <br><span class="hljs-comment line-number">15.</span>       <span class="hljs-number">3</span>: iconst_0      <br><span class="hljs-comment line-number">16.</span>       <span class="hljs-number">4</span>: istore_3      <br><span class="hljs-comment line-number">17.</span>       <span class="hljs-number">5</span>: iload_3       <br><span class="hljs-comment line-number">18.</span>       <span class="hljs-number">6</span>: iconst_5      <br><span class="hljs-comment line-number">19.</span>       <span class="hljs-number">7</span>: <span class="hljs-keyword">if</span>_icmpge     <span class="hljs-number">36</span><br><span class="hljs-comment line-number">20.</span>      <span class="hljs-number">10</span>: new           <span class="hljs-comment">#3                  // class java/lang/StringBuilder</span><br><span class="hljs-comment line-number">21.</span>      <span class="hljs-number">13</span>: dup           <br><span class="hljs-comment line-number">22.</span>      <span class="hljs-number">14</span>: invokespecial <span class="hljs-comment">#4                  // Method java/lang/StringBuilder."&lt;init&gt;":()V</span><br><span class="hljs-comment line-number">23.</span>      <span class="hljs-number">17</span>: aload_2       <br><span class="hljs-comment line-number">24.</span>      <span class="hljs-number">18</span>: invokevirtual <span class="hljs-comment">#5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="hljs-comment line-number">25.</span>      <span class="hljs-number">21</span>: ldc           <span class="hljs-comment">#6                  // String a</span><br><span class="hljs-comment line-number">26.</span>      <span class="hljs-number">23</span>: invokevirtual <span class="hljs-comment">#5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="hljs-comment line-number">27.</span>      <span class="hljs-number">26</span>: invokevirtual <span class="hljs-comment">#7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span><br><span class="hljs-comment line-number">28.</span>      <span class="hljs-number">29</span>: astore_2      <br><span class="hljs-comment line-number">29.</span>      <span class="hljs-number">30</span>: iinc          <span class="hljs-number">3</span>, <span class="hljs-number">1</span><br><span class="hljs-comment line-number">30.</span>      <span class="hljs-number">33</span>: goto          <span class="hljs-number">5</span><br><span class="hljs-comment line-number">31.</span>      <span class="hljs-number">36</span>: getstatic     <span class="hljs-comment">#8                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="hljs-comment line-number">32.</span>      <span class="hljs-number">39</span>: aload_2       <br><span class="hljs-comment line-number">33.</span>      <span class="hljs-number">40</span>: invokevirtual <span class="hljs-comment">#9                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="hljs-comment line-number">34.</span>      <span class="hljs-number">43</span>: <span class="hljs-built_in">return</span>        <br><span class="hljs-comment line-number">35.</span>}<br><span class="hljs-comment line-number">36.</span><br></code></pre></div><div id="wmd-preview-section-1933" class="wmd-preview-section preview-content"></div><div id="wmd-preview-section-footnotes" class="preview-content"></div></div>
                <!-- UY BEGIN -->
        <div id="uyan_frame" style="margin-top: 50px;"></div>
        <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1957046"></script>
        <!-- UY END -->
    </div>
</body>
</html>